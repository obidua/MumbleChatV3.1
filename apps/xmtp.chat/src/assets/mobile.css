/* Mobile-specific styles for PWA */

/* Text selection highlighting - green theme */
::selection {
  background: rgba(16, 185, 129, 0.3);
  color: #ffffff;
}

::-moz-selection {
  background: rgba(16, 185, 129, 0.3);
  color: #ffffff;
}

/* Ensure full viewport height on mobile */
html,
body,
#root {
  height: 100%;
  width: 100%;
  margin: 0;
  padding: 0;
  overflow-x: hidden;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  -webkit-tap-highlight-color: transparent;
}

/* Prevent pull-to-refresh on mobile */
@media screen and (max-width: 768px) {
  body {
    overscroll-behavior-y: contain;
    touch-action: pan-y;
  }

  /* Better scrolling on mobile */
  * {
    -webkit-overflow-scrolling: touch;
  }

  /* Disable text selection on buttons and navigation */
  button,
  nav,
  [role="button"] {
    -webkit-user-select: none;
    user-select: none;
    -webkit-touch-callout: none;
  }

  /* Better tap targets on mobile */
  button,
  a,
  [role="button"] {
    min-height: 44px;
    min-width: 44px;
  }

  /* Improve input behavior on mobile */
  input,
  textarea {
    font-size: 16px; /* Prevents zoom on iOS */
  }

  /* Hide scrollbars but maintain scrolling */
  ::-webkit-scrollbar {
    width: 0;
    height: 0;
    display: none;
  }

  * {
    scrollbar-width: none;
  }
}

/* iOS PWA Safe Area Support for notch devices */
@supports (padding: max(0px)) {
  @media screen and (max-width: 768px) {
    /* Adjust content areas to avoid notch/home indicator */
    .mantine-AppShell-header,
    .header {
      padding-top: max(12px, env(safe-area-inset-top));
      padding-left: max(12px, env(safe-area-inset-left));
      padding-right: max(12px, env(safe-area-inset-right));
    }

    .mantine-AppShell-footer,
    .footer,
    .bottom-nav {
      padding-bottom: max(12px, env(safe-area-inset-bottom));
      padding-left: max(12px, env(safe-area-inset-left));
      padding-right: max(12px, env(safe-area-inset-right));
    }

    /* Ensure modals and overlays respect safe areas */
    .mantine-Modal-content {
      margin-top: env(safe-area-inset-top);
      margin-bottom: env(safe-area-inset-bottom);
    }
  }
}

/* Landscape orientation adjustments */
@media screen and (max-width: 768px) and (orientation: landscape) {
  :root {
    --bottom-nav-height: 56px;
  }
}

/* Animation for page transitions on mobile */
@media screen and (max-width: 768px) {
  @keyframes slideInRight {
    from {
      transform: translateX(100%);
      opacity: 0;
    }
    to {
      transform: translateX(0);
      opacity: 1;
    }
  }

  @keyframes slideOutLeft {
    from {
      transform: translateX(0);
      opacity: 1;
    }
    to {
      transform: translateX(-100%);
      opacity: 0;
    }
  }

  .page-enter {
    animation: slideInRight 0.3s ease-out;
  }

  .page-exit {
    animation: slideOutLeft 0.3s ease-out;
  }
}

/* Fix for modal footers being hidden by bottom navigation */
@media screen and (max-width: 767px) {
  /* Mantine Modal adjustments */
  .mantine-Modal-content {
    max-height: calc(
      100vh - var(--bottom-nav-height) - var(--mobile-safe-area-bottom) - 40px
    ) !important;
  }

  .mantine-Modal-body {
    padding-bottom: 16px !important;
  }

  /* Ensure modals are scrollable when content is too tall */
  .mantine-Modal-inner {
    padding-bottom: calc(
      var(--bottom-nav-height) + var(--mobile-safe-area-bottom) + 20px
    ) !important;
  }

  /* Fix for full-screen modals */
  .mantine-Modal-root[data-full-screen="true"] .mantine-Modal-content {
    max-height: 100vh !important;
    padding-bottom: calc(
      var(--bottom-nav-height) + var(--mobile-safe-area-bottom)
    ) !important;
  }

  /* Ensure modal z-indexes don't interfere with bottom nav */
  .mantine-Modal-overlay {
    z-index: 199 !important;
  }

  .mantine-Modal-inner {
    z-index: 200 !important;
  }

  .mantine-Modal-content {
    z-index: 201 !important;
  }

  /* Ensure bottom navigation stays above everything */
  [class*="bottomNav"],
  [class*="BottomNav"] {
    z-index: 1000 !important;
  }
}

/* Light mode text visibility - Clean and readable */
@media (prefers-color-scheme: light) {
  /* Light mode background colors */
  html,
  body,
  #root {
    background: #f8f9fa !important;
  }

  /* Ensure all text elements have proper contrast in light mode */
  body,
  p,
  span,
  div,
  label,
  button,
  input,
  textarea,
  select {
    color: #212529;
  }

  /* Ensure headings are visible */
  h1,
  h2,
  h3,
  h4,
  h5,
  h6 {
    color: #000000;
  }

  /* Fix for Mantine components */
  .mantine-Text-root {
    color: #212529;
  }

  .mantine-Title-root {
    color: #000000;
  }

  .mantine-TextInput-label,
  .mantine-Textarea-label,
  .mantine-Select-label,
  .mantine-Checkbox-label {
    color: #495057;
  }

  .mantine-TextInput-input,
  .mantine-Textarea-input,
  .mantine-Select-input {
    color: #212529;
    background: #ffffff;
    border-color: rgba(0, 0, 0, 0.12);
  }

  .mantine-TextInput-input::placeholder,
  .mantine-Textarea-input::placeholder,
  .mantine-Select-input::placeholder {
    color: rgba(0, 0, 0, 0.4);
  }

  /* Accordion text visibility */
  .mantine-Accordion-label,
  .mantine-Accordion-control {
    color: #212529;
  }

  .mantine-Accordion-content {
    color: #495057;
  }

  /* Button text visibility */
  .mantine-Button-root {
    color: #ffffff;
  }

  /* Badge text visibility */
  .mantine-Badge-root {
    color: #ffffff;
  }

  /* Menu and dropdown text */
  .mantine-Menu-item,
  .mantine-Menu-label {
    color: #212529;
  }

  /* Modal and dialog text */
  .mantine-Modal-title {
    color: #000000;
  }

  .mantine-Modal-body {
    color: #212529;
  }

  /* Stack and Group children */
  .mantine-Stack-root,
  .mantine-Group-root {
    color: #212529;
  }

  /* Ensure links are visible */
  a {
    color: #2196f3;
  }

  a:hover {
    color: #1976d2;
  }

  /* Fix for dimmed text */
  [data-dimmed="true"],
  .mantine-Text-root[data-c="dimmed"] {
    color: #6c757d !important;
  }

  /* Specific fixes for identity and profile pages */
  .mantine-Stack-root .mantine-Text-root,
  .mantine-Group-root .mantine-Text-root {
    color: #212529 !important;
  }

  /* Fix for code and pre elements */
  code,
  pre {
    color: #212529;
    background: #f8f9fa;
  }

  /* Notification text */
  .mantine-Notification-root {
    color: #212529;
  }

  /* Tab text */
  .mantine-Tabs-tab {
    color: #6c757d;
  }

  .mantine-Tabs-tab[data-active="true"] {
    color: #2196f3;
  }

  /* Main layout components */
  .mantine-AppShell-main,
  .mantine-AppShell-root {
    background: #f8f9fa !important;
  }

  .mantine-AppShell-header {
    background: #ffffff !important;
    border-bottom: 1px solid rgba(0, 0, 0, 0.08) !important;
  }

  .mantine-AppShell-navbar {
    background: #ffffff !important;
    border-right: 1px solid rgba(0, 0, 0, 0.08) !important;
  }

  .mantine-AppShell-footer {
    background: #ffffff !important;
    border-top: 1px solid rgba(0, 0, 0, 0.08) !important;
  }

  /* Cards and containers */
  .mantine-Card-root,
  .mantine-Paper-root {
    background: #ffffff !important;
    border-color: rgba(0, 0, 0, 0.08) !important;
  }

  /* Navigation bar */
  nav {
    background: #ffffff !important;
  }

  /* Conversation list items */
  [class*="ConversationCard"],
  [class*="conversationCard"] {
    background: #ffffff !important;
    border-color: rgba(0, 0, 0, 0.08) !important;
  }

  [class*="ConversationCard"]:hover,
  [class*="conversationCard"]:hover {
    background: #f8f9fa !important;
  }

  /* Message bubbles */
  [class*="message"],
  [class*="Message"] {
    background: #ffffff !important;
  }

  /* Composer area */
  [class*="composer"],
  [class*="Composer"] {
    background: #ffffff !important;
    border-color: rgba(0, 0, 0, 0.08) !important;
  }

  /* Tables */
  .mantine-Table-root {
    background: #ffffff !important;
  }

  .mantine-Table-tr {
    border-color: rgba(0, 0, 0, 0.08) !important;
  }

  /* Popovers and dropdowns */
  .mantine-Popover-dropdown,
  .mantine-Menu-dropdown {
    background: #ffffff !important;
    border-color: rgba(0, 0, 0, 0.08) !important;
  }

  /* Action icons */
  .mantine-ActionIcon-root {
    color: #495057 !important;
  }

  .mantine-ActionIcon-root:hover {
    background: rgba(0, 0, 0, 0.05) !important;
  }

  /* Bottom navigation for mobile */
  [class*="bottomNav"],
  [class*="BottomNav"] {
    background: #ffffff !important;
    border-top: 1px solid rgba(0, 0, 0, 0.08) !important;
  }

  [class*="navItem"] {
    color: rgba(0, 0, 0, 0.6) !important;
  }

  [class*="navItem"]:hover {
    background: rgba(0, 0, 0, 0.05) !important;
  }

  [class*="navItem"][class*="active"] {
    color: #10b981 !important;
    background: rgba(16, 185, 129, 0.1) !important;
  }

  /* Modals background and overlay */
  .mantine-Modal-root {
    color: #212529 !important;
  }

  .mantine-Modal-overlay {
    background: rgba(0, 0, 0, 0.3) !important;
  }

  .mantine-Modal-content {
    background: #ffffff !important;
    color: #212529 !important;
  }

  .mantine-Modal-header {
    background: #ffffff !important;
    border-bottom: 1px solid rgba(0, 0, 0, 0.08) !important;
  }

  /* All message-related components */
  [class*="Message"],
  [class*="message"] {
    background: #ffffff !important;
    border-color: rgba(0, 0, 0, 0.08) !important;
    color: #212529 !important;
  }

  /* Conversation sidebar */
  [class*="ConversationsNavbar"],
  [class*="conversationsNavbar"],
  [class*="shell"] {
    background: linear-gradient(180deg, #ffffff 0%, #f8f9fa 100%) !important;
    border-color: rgba(0, 0, 0, 0.08) !important;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08) !important;
    color: #212529 !important;
  }

  /* App header */
  [class*="AppHeader"],
  [class*="appHeader"],
  [class*="header"]:not([class*="message"]) {
    background: #ffffff !important;
    border-color: rgba(0, 0, 0, 0.08) !important;
  }

  /* Empty states */
  [class*="empty"],
  [class*="Empty"] {
    color: #6c757d !important;
  }

  /* Select/Dropdown components */
  .mantine-Select-dropdown,
  .mantine-MultiSelect-dropdown {
    background: #ffffff !important;
    border-color: rgba(0, 0, 0, 0.08) !important;
  }

  .mantine-Select-option,
  .mantine-MultiSelect-option {
    color: #212529 !important;
  }

  .mantine-Select-option:hover,
  .mantine-MultiSelect-option:hover {
    background: #f8f9fa !important;
  }

  .mantine-Select-option[data-selected],
  .mantine-MultiSelect-option[data-selected] {
    background: rgba(33, 150, 243, 0.1) !important;
  }

  /* Dividers */
  .mantine-Divider-root {
    border-color: rgba(0, 0, 0, 0.08) !important;
  }

  /* Switch components */
  .mantine-Switch-track {
    background: #dee2e6 !important;
    border-color: rgba(0, 0, 0, 0.12) !important;
  }

  .mantine-Switch-track[data-checked] {
    background: #2196f3 !important;
  }

  /* Radio and Checkboxes */
  .mantine-Radio-radio,
  .mantine-Checkbox-input {
    border-color: rgba(0, 0, 0, 0.3) !important;
    background: #ffffff !important;
  }

  .mantine-Radio-radio:checked,
  .mantine-Checkbox-input:checked {
    border-color: #2196f3 !important;
    background: #2196f3 !important;
  }

  /* Loader/Spinner */
  .mantine-Loader-root {
    color: #2196f3 !important;
  }

  /* Tooltips */
  .mantine-Tooltip-tooltip {
    background: rgba(0, 0, 0, 0.9) !important;
    color: #ffffff !important;
  }

  /* Progress bars */
  .mantine-Progress-root {
    background: #e9ecef !important;
  }

  /* Alerts/Notifications */
  .mantine-Alert-root,
  .mantine-Notification-root {
    background: #ffffff !important;
    border-color: rgba(0, 0, 0, 0.08) !important;
  }

  /* Fix remaining dark sections in modals and pages */
  /* Target New Message, Create Group, Identity pages */

  /* All Paper/Card components with dark bg */
  .mantine-Paper-root[style*="background"],
  .mantine-Card-root[style*="background"],
  div[style*="background-color: rgb(31, 41, 55)"],
  div[style*="background-color: rgb(17, 24, 39)"],
  div[style*="background-color: rgb(55, 65, 81)"],
  div[style*="background-color: rgb(30, 41, 59)"],
  div[style*="background: rgb(31, 41, 55)"],
  div[style*="background: rgb(17, 24, 39)"],
  div[style*="background: rgb(55, 65, 81)"],
  div[style*="background: rgb(30, 41, 59)"] {
    background: #ffffff !important;
    background-color: #ffffff !important;
    border: 1px solid rgba(0, 0, 0, 0.08) !important;
  }

  /* Fix text colors in those dark sections */
  div[style*="background-color: rgb(31, 41, 55)"] *,
  div[style*="background-color: rgb(17, 24, 39)"] *,
  div[style*="background-color: rgb(55, 65, 81)"] *,
  div[style*="background-color: rgb(30, 41, 59)"] *,
  div[style*="background: rgb(31, 41, 55)"] *,
  div[style*="background: rgb(17, 24, 39)"] *,
  div[style*="background: rgb(55, 65, 81)"] *,
  div[style*="background: rgb(30, 41, 59)"] * {
    color: #212529 !important;
  }

  /* Fix gray text colors */
  span[style*="color: rgb(156, 163, 175)"],
  span[style*="color: rgb(209, 213, 219)"],
  div[style*="color: rgb(156, 163, 175)"],
  div[style*="color: rgb(209, 213, 219)"],
  p[style*="color: rgb(156, 163, 175)"],
  p[style*="color: rgb(209, 213, 219)"] {
    color: #6c757d !important;
  }

  /* Headings in dark sections */
  h1[style*="color"],
  h2[style*="color"],
  h3[style*="color"],
  h4[style*="color"],
  h5[style*="color"],
  h6[style*="color"] {
    color: #000000 !important;
  }

  /* Green/teal text should stay green but darker */
  span[style*="color: rgb(16, 185, 129)"],
  span[style*="color: rgb(5, 150, 105)"],
  div[style*="color: rgb(16, 185, 129)"],
  div[style*="color: rgb(5, 150, 105)"] {
    color: #059669 !important;
  }

  /* Ensure button text stays visible */
  button {
    color: inherit !important;
  }

  /* Primary buttons keep white text */
  button[style*="background"],
  .mantine-Button-root:not([data-variant="subtle"]):not([data-variant="light"]) {
    color: #ffffff !important;
  }

  /* Stack and Group in dark sections */
  .mantine-Stack-root[style*="background"],
  .mantine-Group-root[style*="background"] {
    background: #ffffff !important;
    background-color: #ffffff !important;
  }
}

/* Dark mode text visibility - Telegram-inspired colors */
@media (prefers-color-scheme: dark) {
  /* Ensure all text elements have proper contrast in dark mode */
  body,
  p,
  span,
  div,
  label,
  button,
  input,
  textarea,
  select {
    color: #e9ecef;
  }

  /* Ensure headings are visible */
  h1,
  h2,
  h3,
  h4,
  h5,
  h6 {
    color: #ffffff;
  }

  /* Fix for Mantine components */
  .mantine-Text-root {
    color: #e9ecef;
  }

  .mantine-Title-root {
    color: #ffffff;
  }

  .mantine-TextInput-label,
  .mantine-Textarea-label,
  .mantine-Select-label,
  .mantine-Checkbox-label {
    color: #adb5bd;
  }

  .mantine-TextInput-input,
  .mantine-Textarea-input,
  .mantine-Select-input {
    color: #e9ecef;
    background: #0f1419;
    border-color: rgba(255, 255, 255, 0.12);
  }

  .mantine-TextInput-input::placeholder,
  .mantine-Textarea-input::placeholder,
  .mantine-Select-input::placeholder {
    color: rgba(255, 255, 255, 0.4);
  }

  /* Accordion text visibility */
  .mantine-Accordion-label,
  .mantine-Accordion-control {
    color: #e9ecef;
  }

  .mantine-Accordion-content {
    color: #adb5bd;
  }

  /* Button text visibility */
  .mantine-Button-root {
    color: #ffffff;
  }

  /* Badge text visibility */
  .mantine-Badge-root {
    color: #ffffff;
  }

  /* Menu and dropdown text */
  .mantine-Menu-item,
  .mantine-Menu-label {
    color: #e9ecef;
  }

  /* Modal and dialog text */
  .mantine-Modal-title {
    color: #ffffff;
  }

  .mantine-Modal-body {
    color: #e9ecef;
  }

  /* Stack and Group children */
  .mantine-Stack-root,
  .mantine-Group-root {
    color: #e9ecef;
  }

  /* Ensure links are visible */
  a {
    color: #2196f3;
  }

  a:hover {
    color: #42a5f5;
  }

  /* Fix for dimmed text */
  [data-dimmed="true"],
  .mantine-Text-root[data-c="dimmed"] {
    color: #6c757d !important;
  }

  /* Specific fixes for identity and profile pages */
  .mantine-Stack-root .mantine-Text-root,
  .mantine-Group-root .mantine-Text-root {
    color: #e9ecef !important;
  }

  /* Fix for code and pre elements */
  code,
  pre {
    color: #e9ecef;
    background: #17212b;
  }

  /* Notification text */
  .mantine-Notification-root {
    color: #e9ecef;
  }

  /* Tab text */
  .mantine-Tabs-tab {
    color: #6c757d;
  }

  .mantine-Tabs-tab[data-active="true"] {
    color: #2196f3;
  }
}
